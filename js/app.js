function _sort_by_key(a,b){function c(a,c){return a[b]===c[b]?0:a[b]>c[b]?1:-1}return a.sort(c)}function _filter_style(a,b){return b||(b="all"),a.filter(function(a,c,d){if(a.general_style===b)return a})}function _filter_brewer(a,b){return a.filter(function(a,c,d){if(a.brewer===b)return a})}function _get_keys(a,b){return a.map(function(a){var c={};for(var d=b.length-1;d>=0;d--)c[b[d]]=a[b[d]];return c})}function _get_category_vals(a,b){var c={};for(i in b)c[b[i][a]]?c[b[i][a]++]:c[b[i][a]]=0;return Object.keys(c).sort()}function sortByRemaining(a){return _sort_by_key(a,"remaining").reverse()}function getStyles(a){return _get_category_vals("general_style",a)}function getBrewers(a){return _get_category_vals("brewer",a)}function r(a){return Math.round(a*100/100)}function initLists(a,b){var c=getStyles(a),d;for(i in c){var e="";c[i]===b&&(e=" selected"),d+="<option"+e+">"+c[i]+"</option>"}$("#styles").append(d),$("#busy").html("&nbsp;")}function displayBeers(a){a=_sort_by_key(a,"remaining");var b="<ul>";for(var c=a.length-1;c>=0;c--){var d=a[c];b+='<li class="beer-list-item"><div class="name">'+d.name+"</div>"+'<div class="pct">'+r(d.remaining)+"%</div>"+"</li>"}$("#beers").html(b+"</ul>")}function brewerListGen(){var a=getBrewers(beerme._dbcache);return a.map(function(a){var b=sortByRemaining(_filter_brewer(beerme._dbcache,a)).map(function(a){return _formatItem(a)}).join("\n");return'<li><a href="#'+a+'">'+a+"</a>"+"<ul>"+b+"</ul>"+"</li>"}).join("\n")}function styleListGen(){var a=getStyles(beerme._dbcache);return a.map(function(a){return'<li><a href="#'+a+'">'+a+"</a>"+"<ul>"+sortByRemaining(_filter_style(beerme._dbcache,a)).map(function(a){return _formatItem(a)}).join("\n")+"</ul>"+"</li>"}).join("\n")}function fetch(){beerme._brewer_cache=null,$.getJSON(url,function(a){beerme._dbcache=a,window.setTimeout(function(){beerme._brewer_cache=brewerListGen()},400),window.setTimeout(function(){beerme._style_cache=styleListGen()},0)})}function _formatItem(a){return"<li>"+a.name+'<span class="ui-li-count">'+r(a.remaining)+"</span></li>"}var requirejs,require,define;(function(a){function g(a,b){if(a&&a.charAt(0)==="."&&b){b=b.split("/"),b=b.slice(0,b.length-1),a=b.concat(a.split("/"));var c,d;for(c=0;d=a[c];c++)if(d===".")a.splice(c,1),c-=1;else if(d===".."){if(c===1&&(a[2]===".."||a[0]===".."))break;c>0&&(a.splice(c-1,2),c-=2)}a=a.join("/")}return a}function h(b,c){return function(){return f.apply(a,d.call(arguments,0).concat([b,c]))}}function i(a){return function(b){return g(b,a)}}function j(a){return function(c){b[a]=c}}function k(d){if(c.hasOwnProperty(d)){var f=c[d];delete c[d],e.apply(a,f)}return b[d]}function l(a,b){var c,d,e=a.indexOf("!");return e!==-1?(c=g(a.slice(0,e),b),a=a.slice(e+1),d=k(c),d&&d.normalize?a=d.normalize(a,i(b)):a=g(a,b)):a=g(a,b),{f:c?c+"!"+a:a,n:a,p:d}}var b={},c={},d=[].slice,e,f;if(typeof define=="function")return;e=function(d,e,f,g){var i=[],m,n,o,p,q,r;g||(g=d);if(typeof f=="function"){!e.length&&f.length&&(e=["require","exports","module"]);for(p=0;p<e.length;p++){r=l(e[p],g),o=r.f;if(o==="require")i[p]=h(d);else if(o==="exports")i[p]=b[d]={},m=!0;else if(o==="module")n=i[p]={id:d,uri:"",exports:b[d]};else if(b.hasOwnProperty(o)||c.hasOwnProperty(o))i[p]=k(o);else{if(!r.p)throw d+" missing "+o;r.p.load(r.n,h(g,!0),j(o),{}),i[p]=b[o]}}q=f.apply(b[d],i),d&&(n&&n.exports!==a?b[d]=n.exports:m||(b[d]=q))}else d&&(b[d]=f)},requirejs=f=function(b,c,d,g){return typeof b=="string"?k(l(b,c).f):(b.splice||(c.splice?(b=c,c=arguments[2]):b=[]),g?e(a,b,c,d):setTimeout(function(){e(a,b,c,d)},15),f)},f.config=function(){return f},require||(require=f),define=function(a,b,d){b.splice||(d=b,b=[]),define.unordered?c[a]=[a,b,d]:e(a,b,d)},define.amd={jQuery:!0}})(),define("almond",function(){});var pp=function(a){return JSON.stringify(a,null,"  ")},L=console.log,beerme={};beerme._dbcache=[],beerme._brewer_cache=null;var DEBUG=!1,beerCache=[],url=!1;DEBUG?url="http://localhost:8000/server/debug.json":url="http://live-menu.staugustinesvancouver.com/taps.json?offset=0&amount=9999&callback=?";var global=this,pp=function(a){return JSON.stringify(a,null,"  ")},L=console.log;$(document).bind("pageinit",function(){$(document).delegate("#all","pageinit",function(){var a=sortByRemaining(beerme._dbcache),b=beerme._dbcache.map(function(a){return _formatItem(a)}).join("\n");$("#all-beers").html(b).listview("refresh")}),$(document).delegate("#styles","pageinit",function(){beerme._style_cache||(beerme._style_cache=styleListGen()),$("#style-list").html(beerme._style_cache).listview("refresh")}),$(document).delegate("#brewers","pageinit",function(){beerme._brewer_cache||(beerme._brewer_cache=brewerListGen()),$("#brewer-list").html(beerme._brewer_cache).listview("refresh")})}),$(function(){fetch()}),define("app",function(){})